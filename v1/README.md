# AI Twin - Telegram Integration

## Новая функция: Реальная интеграция с Telegram User API

Теперь ваши цифровые двойники могут **РЕАЛЬНО** отвечать за вас в Telegram через MTProto API! 

### Что реализовано:

####  **НАСТОЯЩАЯ** Telegram User API интеграция
- **MTProto клиент**: Полноценная реализация протокола Telegram
- **Реальная авторизация**: Настоящие коды из Telegram, не симуляция
- **Живое прослушивание**: Получение сообщений в реальном времени
- **Автоматические ответы**: ИИ отвечает от вашего имени

####  Telegram Bot Management (старая функция)
- **Создание и управление ботами**: Простой интерфейс для подключения Telegram ботов
- **Статус мониторинг**: Отслеживание активности и состояния ботов
- **Безопасность**: Шифрование токенов и контроль доступа

####  Интеграция с Digital Twins
- **Подключение двойников**: Связывание с вашими ИИ-двойниками
- **Персональные ответы**: ИИ отвечает в вашем стиле на основе анализа переписок
- **Контекстные диалоги**: Сохранение истории разговоров для лучшего понимания

####  Голосовые возможности
- **Speech-to-Text**: Автоматическое распознавание голосовых сообщений (OpenAI Whisper)
- **Text-to-Speech**: Ответы клонированным голосом (интеграция с ElevenLabs)
- **Голосовые настройки**: Включение/отключение голосовых ответов

####  Мониторинг и аналитика
- **История сообщений**: Просмотр всех обработанных сообщений
- **Статистика**: Количество сообщений, активность
- **Real-time обновления**: Автоматическое обновление статуса

### Как это работает (User API):

1. **Авторизация**: Вводите свой номер телефона и получаете код в Telegram
2. **MTProto сессия**: Создается постоянная сессия с Telegram серверами
3. **Прослушивание**: Система слушает входящие сообщения в реальном времени
4. **Обработка**: ИИ-двойник анализирует сообщение и генерирует ответ
5. **Отправка**: Ответ отправляется от вашего имени с задержкой для имитации человека

### Технические детали:

#### Frontend
- ✅ Новая страница `TelegramUserIntegrationPage`
- ✅ Управление сессиями и интеграциями
- ✅ Просмотр истории сообщений
- ✅ Интеграция с существующими сервисами

#### Backend (РЕАЛИЗОВАНО!)
- ✅ **MTProto клиент**: Полноценная реализация через gramjs
- ✅ **Реальная авторизация**: Настоящие коды из Telegram API
- ✅ **Live прослушивание**: Получение сообщений в реальном времени
- ✅ **Speech-to-Text**: Распознавание голосовых сообщений (OpenAI Whisper)
- ✅ **Text-to-Speech**: Генерация голосовых ответов (ElevenLabs)
- ✅ **Message Queue**: Обработка сообщений с задержками

#### База данных
- ✅ Таблица `telegram_sessions` для хранения MTProto сессий
- ✅ Таблица `telegram_user_messages` для истории сообщений
- ✅ Таблица `telegram_integrations` для настроек интеграций
- ✅ RLS политики для безопасности
- ✅ Индексы для оптимизации

### Настройка:

1. **Python API Server** (уже развернут):
   ```
   API Base URL: http://85.202.193.46:8000
   Authorization: Bearer Alfa2000@
   ```

2. **Доступные эндпоинты**:
   ```
   POST /auth/auth/request_code - Запрос кода авторизации
   POST /auth/auth/verify_code - Проверка кода
   POST /get_dialogs - Получение списка диалогов  
   POST /send_message - Отправка сообщений
   ```

3. **Дополнительные API ключи** (опционально):
   ```env
   OPENAI_API_KEY=your_openai_key_here  # для Whisper STT
   ELEVENLABS_API_KEY=your_elevenlabs_key_here  # для TTS
   GEMINI_API_KEY=your_gemini_key_here  # для ИИ ответов
   ```

### Использование:

1. Перейдите в раздел "Telegram User API" в боковом меню
2. Нажмите "Подключить аккаунт" 
3. Введите свой номер телефона (например: +77078706666)
4. Введите код, полученный в Telegram
5. После успешной авторизации выберите цифрового двойника
6. Настройте параметры автоответов
7. Ваш ИИ-двойник начнет отвечать за вас через Python API!

### Возможности:

- ✅ **Реальная авторизация**: Через Python MTProto API
- ✅ **Автоответы**: ИИ отвечает на входящие сообщения  
- ✅ **Голосовые сообщения**: Распознавание и генерация голоса
- ✅ **Умные задержки**: Имитация человеческого поведения
- ✅ **Рабочие часы**: Настройка времени работы
- ✅ **Персонализация**: Ответы в вашем стиле общения
- ✅ **Стабильная работа**: Через внешний Python сервер
